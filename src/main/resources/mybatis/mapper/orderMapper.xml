<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dian.mmall.dao.OrderMapper">
	<select id="get_conduct_order" resultType="int">
		select count(*) from orderform where
		wholesaleCommodityId=#{wholesaleCommodityId}
		<if test="orderStatus==0">and `orderStatus` in (1,2,4)   </if>
		<!-- <if test="orderStatus==99"> and `orderStatus` in (1,2,4) </if> -->

	</select>


	<!--创建用户成功返回非0 -->
	<insert id="create_order">
		insert into orderform (
		purchaseUserId,saleUserId,wholesaleCommodityId,evaluateid,commodityJiage,commodityCountNo,
		commodityZongJiage ,reserve
		,deliveryType,deliveryCollect,addressDetailed,giveTakeTime,remarks,
		createTime,confirmTime,paymentTime,guanShanTime,guanShanReason,collectTime,orderStatus,payStatus,
		commoditySnapshot,releaseType,permissionId,guaranteeMoney,yesGuaranteeMoney,balanceMoney
		) values (
		#{purchaseUserId},#{saleUserId},#{wholesaleCommodityId},#{evaluateid},#{commodityJiage},#{commodityCountNo},
		#{commodityZongJiage},#{reserve},
		#{deliveryType},#{deliveryCollect},#{addressDetailed},#{giveTakeTime},#{remarks},
		#{createTime},#{confirmTime},#{paymentTime},#{guanShanTime},#{guanShanReason},#{collectTime},#{orderStatus},#{payStatus},
		#{commoditySnapshot},#{releaseType},#{permissionId},#{guaranteeMoney},#{yesGuaranteeMoney},#{balanceMoney}
		)
	</insert>
	<select id="getId" resultType="long">
		select id from orderform where
		purchaseUserId=#{purchaseUserId}
		and createTime=#{createTime}
		and
		orderStatus=#{orderStatus}
	</select>

	<select id="get_shut_orders"
		resultType="com.dian.mmall.pojo.Order">
		select * from orderform where
		purchaseUserId=#{purchaseUserId}
		and
		createTime between #{between} and #{and}
		and reserve=3
		<if test="type == 2">
			and orderStatus not IN
			<foreach item="item" index="index"
				collection="orderStatus_liStrings" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</select>


</mapper>